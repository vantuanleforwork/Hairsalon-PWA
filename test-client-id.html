<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Client ID Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Google Client ID Verification</h1>
    <div id="results"></div>
    
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="config.js"></script>
    
    <script>
        const resultsDiv = document.getElementById('results');
        
        function addResult(type, title, message, details = null) {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = `
                <h3>${title}</h3>
                <p>${message}</p>
                ${details ? `<pre>${details}</pre>` : ''}
            `;
            resultsDiv.appendChild(div);
        }
        
        function checkClientId() {
            console.log('üîç Starting Client ID verification...');
            
            // Step 1: Check if config is loaded
            if (typeof APP_CONFIG === 'undefined') {
                addResult('error', '‚ùå Configuration Error', 'APP_CONFIG is not loaded');
                return;
            }
            
            const clientId = APP_CONFIG.GOOGLE_CLIENT_ID;
            
            // Step 2: Check if Client ID exists
            if (!clientId) {
                addResult('error', '‚ùå Client ID Missing', 'No Google Client ID found in configuration');
                return;
            }
            
            // Step 3: Check Client ID format
            const clientIdPattern = /^[0-9]+-[a-zA-Z0-9]+\.apps\.googleusercontent\.com$/;
            if (!clientIdPattern.test(clientId)) {
                addResult('error', '‚ùå Invalid Client ID Format', 
                    `Client ID format is invalid: ${clientId}`,
                    `Expected format: NUMBERS-CHARACTERS.apps.googleusercontent.com`);
                return;
            }
            
            addResult('success', '‚úÖ Client ID Format Valid', 
                `Client ID format is correct: ${clientId.substring(0, 20)}...${clientId.substring(clientId.length-20)}`);
            
            // Step 4: Check Google API availability
            setTimeout(() => {
                if (typeof google === 'undefined') {
                    addResult('error', '‚ùå Google API Not Loaded', 
                        'Google Identity Services script failed to load');
                    return;
                }
                
                if (!google.accounts || !google.accounts.id) {
                    addResult('error', '‚ùå Google Identity API Missing', 
                        'Google Identity Services API is not available');
                    return;
                }
                
                addResult('success', '‚úÖ Google API Loaded', 'Google Identity Services is available');
                
                // Step 5: Test Client ID initialization
                try {
                    google.accounts.id.initialize({
                        client_id: clientId,
                        callback: function(response) {
                            console.log('Test callback triggered');
                        }
                    });
                    
                    addResult('success', '‚úÖ Client ID Initialization', 
                        'Google OAuth initialized successfully with this Client ID');
                    
                    // Step 6: Additional info
                    addResult('info', '‚ÑπÔ∏è Configuration Details', '', 
                        JSON.stringify({
                            clientId: clientId,
                            allowedEmails: APP_CONFIG.ALLOWED_EMAILS,
                            productionUrl: APP_CONFIG.PRODUCTION_URL,
                            currentUrl: window.location.href,
                            debugMode: APP_CONFIG.DEBUG_MODE
                        }, null, 2));
                    
                } catch (error) {
                    addResult('error', '‚ùå Client ID Initialization Failed', 
                        `Error initializing Google OAuth: ${error.message}`);
                }
                
            }, 1000);
        }
        
        // Start check when page loads
        window.addEventListener('load', checkClientId);
    </script>
</body>
</html>
